# EmuAIO 项目代码文档

## 项目概述
EmuAIO 是一个基于 Flutter 开发的动车组信息查询应用，提供车次查询、车号查询、路局查询、动车图鉴等全方位功能。

## 核心功能模块

### 1. 列车图标模型映射 (train_model.dart)
提供列车图标模型名称的智能映射逻辑。

**主要功能：**
- 根据车型和车号确定对应的图标模型
- 处理特殊车型的图标映射规则
- 支持CRH、CR系列等多种动车组类型

**核心类：** `TrainModelUtils`
- `getTrainIconModel(String model, String number)` - 获取列车图标模型名称
- `getBureauFullNames()` - 获取路局全名列表

**特殊映射规则示例：**
- CRH6A车型根据车号范围映射到CRH6-2
- CRH1B车型特定车号映射到CRH1E
- CR400系列智能动车组的特殊处理

### 2. 关于页面 (about_page.dart)
显示应用信息和版权声明的页面。

**界面组成：**
- 应用头信息区域
- 版本信息卡片
- 数据来源说明
- 版权声明区域
- 应用横幅图片

**特性：**
- 自适应深色/浅色主题
- 响应式布局设计
- 错误图片加载处理

### 3. 颜色主题系统 (color_theme.dart)
提供完整的主题颜色配置和工具类。

**核心组件：**
- `AppColors` - 定义所有颜色常量
- `ColorThemeUtils` - 主题构建工具
- 支持深夜模式主题配置

**颜色系统：**
- 主色调：`#4DB6AC` (Teal)
- 匹配度颜色：高(绿)、中(橙)、低(红)
- 完整的Material 3颜色方案

### 4. 主应用入口 (main.dart)
应用的主入口文件和核心设置管理。

**核心功能：**
- 应用初始化配置
- 设置管理 (`AppSettings` 类)
- 图标包管理系统
- 主题模式切换

**设置管理特性：**
- 主题模式管理 (浅色/深色/深夜模式)
- 图标包动态加载和切换
- 设置持久化存储
- 多语言支持

### 5. 设置页面 (settings_page.dart)
用户设置和配置界面。

**设置分类：**
- 主题设置 (深色模式、深夜模式)
- 图标显示设置 (列车图标、路局图标)
- 图标包管理
- 应用信息检查更新

**图标包管理功能：**
- ZIP格式图标包导入
- Manifest.json配置文件解析
- 图标包验证和错误处理
- 多图标包切换支持

### 6. 图鉴页面 (gallery_page.dart)
动车组图片和信息的展示页面。

**页面结构：**
- 标签页导航 (热门车型、检测列车、其他车型、特殊涂装)
- WebView完整图鉴展示
- 响应式卡片布局

**数据模型：** `TrainInfo`
- 车型信息存储结构
- 支持分段标题显示
- 详细信息键值对展示

## 技术架构

### 状态管理
- 使用Provider进行状态管理
- SharedPreferences本地数据持久化
- 响应式UI更新

### 网络功能
- http库用于API调用
- WebView内嵌网页浏览
- 文件下载和更新检查

### 数据存储
- JSON格式本地数据存储
- 文件系统图标包管理
- 设置偏好持久化

## 图标系统

### 默认图标包
- 内置assets资源图标
- 支持车型到图标文件的映射
- 错误处理和备用图标显示

### 自定义图标包
- ZIP格式打包支持
- Manifest.json配置文件
- 动态加载和缓存管理
- 图标包元信息提取

## 主题系统

### 主题模式
- Light Mode (浅色模式)
- Dark Mode (深色模式)  
- Midnight Mode (深夜模式)

### 自适应特性
- 自动跟随系统主题
- 手动切换支持
- 颜色对比度优化

## 错误处理

### 图片加载错误处理
- 备用图标显示
- 加载状态指示
- 网络图片缓存

### 图标包验证
- 文件格式检查
- Manifest解析验证
- 图标文件完整性检查

## 性能优化

### 图片优化
- 图片懒加载
- 内存缓存管理
- 图片尺寸优化

### 数据加载
- 分页数据加载
- 异步数据获取
- 内存泄漏防护

## 开发工具类

### 工具函数
- 颜色工具类
- 字符串处理
- 文件操作工具
- 网络请求工具


